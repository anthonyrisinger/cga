### Appendix B: The Complete Formula Reference

This appendix provides a comprehensive compilation of essential formulas organized by application area. Each formula includes context, constraints, and computational considerations for practical implementation.

#### Conformal Embeddings and Extractions

**Point Embedding (Euclidean to Conformal)**

$$P = \mathbf{p} + \frac{1}{2}\|\mathbf{p}\|^2\mathbf{n}_\infty + \mathbf{n}_0$$

- Input: Euclidean point $\mathbf{p} \in \mathbb{R}^n$
- Output: Conformal point $P$ satisfying $P^2 = 0$
- Normalization: Often scaled so $P \cdot \mathbf{n}_\infty = -1$
- Computational note: The coefficient $\frac{1}{2}$ ensures correct distance encoding

**Point Extraction (Conformal to Euclidean)**

General form:
$$\mathbf{p} = \frac{P \wedge \mathbf{n}_0 \wedge I_n}{-(P \cdot \mathbf{n}_\infty)I_n\mathbf{n}_\infty}$$

Simplified for normalized points where $P \cdot \mathbf{n}_\infty = -1$:
$$\mathbf{p} = -\frac{(P \wedge \mathbf{n}_0) \cdot I_c}{I_c \cdot \mathbf{n}_\infty}$$

Alternative direct extraction:
$$\mathbf{p} = \frac{P - (P \cdot \mathbf{n}_\infty)\mathbf{n}_0 - (P \cdot \mathbf{n}_0)\mathbf{n}_\infty}{-(P \cdot \mathbf{n}_\infty)}$$

**Sphere Representation (IPNS)**

$$S = C - \frac{1}{2}r^2\mathbf{n}_\infty$$

where $C$ is the conformal center point and $r$ is the radius.

Expanded form:
$$S = \mathbf{c} + \frac{1}{2}\|\mathbf{c}\|^2\mathbf{n}_\infty + \mathbf{n}_0 - \frac{1}{2}r^2\mathbf{n}_\infty$$

Properties:
- $S^2 = r^2$ (squared radius extraction)
- Degenerate when $r = 0$ (point)
- Center extraction: $\mathbf{c} = \frac{S\mathbf{n}_\infty S}{S \cdot \mathbf{n}_\infty}$
- Radius extraction: $r = \sqrt{S^2}$ when $S^2 > 0$

**Plane Representation (IPNS)**

$$\pi = \mathbf{n} + d\mathbf{n}_\infty$$

- $\mathbf{n}$: Unit normal vector ($\|\mathbf{n}\| = 1$)
- $d$: Signed distance from origin
- Constraint: $\pi^2 = 1$ for normalized plane
- Point-plane incidence: $P \cdot \pi = 0$

#### Geometric Relationships

**Distance Between Points**

$$d^2 = -2P_1 \cdot P_2$$

- Direct computation from conformal inner product
- No square root needed for distance comparisons
- For normalized points: $d^2 = 2 - 2P_1 \cdot P_2$

**Point-to-Plane Distance**

$$d = \frac{P \cdot \pi}{-P \cdot \mathbf{n}_\infty}$$

- Sign indicates which side of plane
- For normalized points: denominator equals $-1$
- Alternative form: $d = P \cdot \pi$ when $P$ is normalized

**Point-to-Sphere Relationship**

$$P \cdot S = \frac{1}{2}(d_{PC}^2 - r^2)$$

where $d_{PC}$ is distance from point to sphere center.

Classification:
- $P \cdot S < 0$: Point inside sphere
- $P \cdot S = 0$: Point on sphere
- $P \cdot S > 0$: Point outside sphere

**Point-to-Line Distance**

For line $L$ and point $P$:
$$d^2 = \frac{-2(P \wedge L)^2}{L^2}$$

**Angle Between Vectors**

$$\cos\theta = \frac{\mathbf{a} \cdot \mathbf{b}}{\|\mathbf{a}\|\|\mathbf{b}\|}$$

**Angle Between Bivectors**

$$\cos\theta = \frac{\langle B_1\tilde{B}_2 \rangle_0}{\|B_1\|\|B_2\|}$$

**Angle Between Planes**

For normalized planes $\pi_1, \pi_2$:
$$\cos\theta = \pi_1 \cdot \pi_2$$

**Angle Between Lines**

For lines $L_1, L_2$ as bivectors:
$$\cos\theta = \frac{|L_1 \cdot L_2|}{\|L_1\|\|L_2\|}$$

#### Transformation Construction Formulas

**Reflection Across Hyperplane**

$$X' = -\pi X \pi$$

where $\pi$ is a unit vector representing the hyperplane normal.

**Rotation by Angle Î¸**

Rotor construction:
$$R = \exp\left(-\frac{\theta}{2}B\right) = \cos\frac{\theta}{2} - \sin\frac{\theta}{2}B$$

- $B$: Unit bivector defining rotation plane ($B^2 = -1$)
- Application: $X' = RXR^{-1} = RX\tilde{R}$
- Inverse: $R^{-1} = \tilde{R}$ for unit rotors
- Composition: $R_{total} = R_2R_1$ (apply $R_1$ first)

**Translation by Vector t**

$$T = \exp\left(-\frac{\mathbf{t}\mathbf{n}_\infty}{2}\right) = 1 - \frac{\mathbf{t}\mathbf{n}_\infty}{2}$$

- Note: $(\mathbf{t}\mathbf{n}_\infty)^2 = 0$ simplifies exponential
- Inverse: $T^{-1} = 1 + \frac{\mathbf{t}\mathbf{n}_\infty}{2}$
- Composition: $T_1T_2 = T_{\mathbf{t}_1 + \mathbf{t}_2}$

**Uniform Scaling from Origin**

$$D = \exp\left(\frac{\lambda}{2}\mathbf{n}_0\mathbf{n}_\infty\right)$$

where scale factor is $s = e^\lambda$.

Alternative forms:
$$D = \cosh\frac{\lambda}{2} + \sinh\frac{\lambda}{2}\mathbf{n}_0\mathbf{n}_\infty$$
$$D = \frac{1 + s}{2} + \frac{1 - s}{2}\mathbf{n}_0\mathbf{n}_\infty$$

**Motor (General Rigid Motion)**

For screw motion with axis $L$, angle $\theta$, pitch $h$:
$$M = \exp\left(-\frac{\theta}{2}L^*I_c - \frac{h\theta}{2\pi}\mathbf{n}_\infty\right)$$

Common form as product:
$$M = TR$$
where $T$ is translation and $R$ is rotation.

**Inversion in Sphere**

For sphere $S$ with center $\mathbf{c}$ and radius $r$:
$$X' = SXS^{-1}$$

#### Intersection Operations

**Universal Meet Formula**

$$A \vee B = (A^* \wedge B^*)^*$$

where $*$ denotes dual with respect to pseudoscalar $I_c$.

**Common Intersection Results**

| First Object | Second Object | Result Type | Formula/Notes |
|--------------|---------------|-------------|---------------|
| Line $L$ | Plane $\pi$ | Point | $L \vee \pi$ |
| Plane $\pi_1$ | Plane $\pi_2$ | Line | $\pi_1 \vee \pi_2$ |
| Sphere $S$ | Plane $\pi$ | Circle | $S \vee \pi$ |
| Sphere $S_1$ | Sphere $S_2$ | Circle | $S_1 \vee S_2$ |
| Line $L$ | Sphere $S$ | Point pair | $L \vee S$ |
| Circle $C$ | Line $L$ | Point pair | $C \vee L$ |

**Construction Formulas**

Line through two points:
$$L = P_1 \wedge P_2 \wedge \mathbf{n}_\infty$$

Plane through three points:
$$\pi = (P_1 \wedge P_2 \wedge P_3 \wedge \mathbf{n}_\infty)^*$$

Circle through three points:
$$C = P_1 \wedge P_2 \wedge P_3$$

Sphere through four points:
$$S = (P_1 \wedge P_2 \wedge P_3 \wedge P_4)^*$$

#### Projection Formulas

**Point onto Line**

$$P_{\text{proj}} = \frac{(P \lrcorner L)L}{L \cdot \tilde{L}}$$

Alternative using meet:
$$P_{\text{proj}} = L \vee (P \wedge \mathbf{n}_\infty)$$

**Point onto Plane**

$$P_{\text{proj}} = P - 2\frac{P \cdot \pi}{\pi^2}\pi$$

For normalized plane ($\pi^2 = 1$):
$$P_{\text{proj}} = P - 2(P \cdot \pi)\pi$$

**Line onto Plane**

$$L_{\text{proj}} = (L \lrcorner \pi^*) \vee \pi$$

#### Interpolation and Path Formulas

**Linear Point Interpolation**

$$P(t) = \frac{(1-t)P_0 + tP_1}{\|(1-t)P_0 + tP_1\|}$$

- Maintains null property through normalization
- Not geodesic on null cone
- For small displacements, normalization can be omitted

**Rotor Interpolation (SLERP)**

$$R(t) = R_0(R_0^{-1}R_1)^t$$

Implementation via logarithm:
$$R(t) = R_0\exp(t\log(R_0^{-1}R_1))$$

where for rotor $R = \cos\frac{\theta}{2} + \sin\frac{\theta}{2}B$:
$$\log(R) = \frac{\theta}{2}B$$

**Motor Interpolation**

$$M(t) = M_0\exp(t\log(M_0^{-1}M_1))$$

- Preserves screw motion characteristics
- Requires care with branch cuts in logarithm
- Produces helical interpolation path

#### Numerical Stability Formulas

**Null Cone Projection**

For approximately null vector $P'$:
$$P = P' - \frac{P'^2}{2(P' \cdot \mathbf{n}_\infty)}\mathbf{n}_\infty$$

**Versor Normalization**

For approximate versor $V'$:
$$V = \frac{V'}{\sqrt{\langle V'\tilde{V'} \rangle_0}}$$

For rotors specifically:
$$R = \frac{R}{\|R\|}$$
where $\|R\|^2 = \langle R\tilde{R} \rangle_0$

**Robust Line-Line Distance**

For skew lines $L_1, L_2$:
$$d = \frac{\|(L_1 \vee L_2) \cdot \mathbf{n}_\infty\|}{\|L_1 \wedge L_2\|}$$

**Numerical Blade Normalization**

For blade $B$ of grade $k$:
$$B_{normalized} = \frac{B}{\sqrt{|B \cdot \tilde{B}|}}$$

#### Special Computational Forms

**Bivector Exponential (Numerically Stable)**

For bivector $B$ with $B^2 = -\theta^2 < 0$:
$$\exp(B) = \begin{cases}
1 + B + \frac{B^2}{2} + \frac{B^3}{6} & \text{if } \theta < \epsilon \\
\cos\theta + \frac{\sin\theta}{\theta}B & \text{otherwise}
\end{cases}$$

For $B^2 = \phi^2 > 0$:
$$\exp(B) = \cosh\phi + \frac{\sinh\phi}{\phi}B$$

**Rotor from Two Vectors**

Given unit vectors $\mathbf{a}, \mathbf{b}$:
$$R = \frac{1 + \mathbf{b}\mathbf{a}}{\|1 + \mathbf{b}\mathbf{a}\|}$$

This rotates $\mathbf{a}$ to $\mathbf{b}$ in their common plane.

**Motor Decomposition**

Given motor $M$, extract translation and rotation:
1. Rotation: $R = \frac{M}{\|M\|}$ (normalize to unit)
2. Translation: Extract from $M\tilde{R}$

---
